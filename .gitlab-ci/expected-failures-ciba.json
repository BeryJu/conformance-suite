[
    {
        "test-name": "fapi-ciba-id1-ensure-authorization-request-with-potentially-bad-binding-message",
        "variant": {
                "client_auth_type": "mtls",
                "fapi_profile": "plain_fapi",
                "ciba_mode": "poll"
        },
        "configuration-filename": "authlete-fapi-ciba-id1-mtls-poll.json",
        "current-block": "Resource server endpoint tests",
        "condition": "ExpectBindingMessageCorrectDisplay",
        "expected-result": "failure"
    },
    {
        "test-name": "fapi-ciba-id1-ensure-authorization-request-with-potentially-bad-binding-message",
        "variant": {
                "client_auth_type": "mtls",
                "fapi_profile": "plain_fapi",
                "ciba_mode": "ping"
        },
        "configuration-filename": "authlete-fapi-ciba-id1-mtls-ping-dcr.json",
        "current-block": "Resource server endpoint tests",
        "condition": "ExpectBindingMessageCorrectDisplay",
        "expected-result": "failure"
    },
    {
        "test-name": "fapi-ciba-id1-ensure-authorization-request-with-potentially-bad-binding-message",
        "variant": {
                "client_auth_type": "private_key_jwt",
                "fapi_profile": "plain_fapi",
                "ciba_mode": "poll"
        },
        "configuration-filename": "authlete-fapi-ciba-id1-privatekey-poll.json",
        "current-block": "Resource server endpoint tests",
        "condition": "ExpectBindingMessageCorrectDisplay",
        "expected-result": "failure"
    },
    {
        "test-name": "fapi-ciba-id1-ensure-authorization-request-with-potentially-bad-binding-message",
        "variant": {
                "client_auth_type": "private_key_jwt",
                "fapi_profile": "plain_fapi",
                "ciba_mode": "ping"
        },
        "configuration-filename": "authlete-fapi-ciba-id1-privatekey-ping-dcr.json",
        "current-block": "Resource server endpoint tests",
        "condition": "ExpectBindingMessageCorrectDisplay",
        "expected-result": "failure"
    },
    {
        "test-name": "fapi-ciba-id1-ensure-authorization-request-with-potentially-bad-binding-message",
        "variant": {
                "client_auth_type": "mtls",
                "fapi_profile": "openbanking_uk",
                "ciba_mode": "poll"
        },
        "configuration-filename": "authlete-fapi-ciba-id1-mtls-poll.json",
        "current-block": "Resource server endpoint tests",
        "condition": "ExpectBindingMessageCorrectDisplay",
        "expected-result": "failure"
    },
    {
        "test-name": "fapi-ciba-id1-ensure-authorization-request-with-potentially-bad-binding-message",
        "variant": {
                "client_auth_type": "mtls",
                "fapi_profile": "openbanking_uk",
                "ciba_mode": "ping"
        },
        "configuration-filename": "authlete-fapi-ciba-id1-mtls-ping-dcr.json",
        "current-block": "Resource server endpoint tests",
        "condition": "ExpectBindingMessageCorrectDisplay",
        "expected-result": "failure"
    },
    {
        "test-name": "fapi-ciba-id1-ensure-authorization-request-with-potentially-bad-binding-message",
        "variant": {
                "client_auth_type": "private_key_jwt",
                "fapi_profile": "openbanking_uk",
                "ciba_mode": "poll"
        },
        "configuration-filename": "authlete-fapi-ciba-id1-privatekey-poll.json",
        "current-block": "Resource server endpoint tests",
        "condition": "ExpectBindingMessageCorrectDisplay",
        "expected-result": "failure"
    },
    {
        "test-name": "fapi-ciba-id1-ensure-authorization-request-with-potentially-bad-binding-message",
        "variant": {
                "client_auth_type": "private_key_jwt",
                "fapi_profile": "openbanking_uk",
                "ciba_mode": "ping"
        },
        "configuration-filename": "authlete-fapi-ciba-id1-privatekey-ping-dcr.json",
        "current-block": "Resource server endpoint tests",
        "condition": "ExpectBindingMessageCorrectDisplay",
        "expected-result": "failure"
    },
    {
        "test-name": "fapi-ciba-id1-refresh-token",
        "variant": {
                "client_auth_type": "private_key_jwt",
                "fapi_profile": "plain_fapi",
                "ciba_mode": "poll"
        },
        "configuration-filename": "authlete-fapi-ciba-id1-privatekey-poll.json",
        "current-block": "Second client: Check for refresh token",
        "condition": "EnsureServerConfigurationDoesNotSupportRefreshToken",
        "expected-result": "warning",
        "comment": "The second client in this configuration does not get issued a refresh token, which is now a warning"
    },
    {
        "test-name": "fapi-ciba-id1-refresh-token",
        "variant": {
                "client_auth_type": "private_key_jwt",
                "fapi_profile": "openbanking_uk",
                "ciba_mode": "poll"
        },
        "configuration-filename": "authlete-fapi-ciba-id1-privatekey-poll.json",
        "current-block": "Second client: Check for refresh token",
        "condition": "EnsureServerConfigurationDoesNotSupportRefreshToken",
        "expected-result": "warning",
        "comment": "The second client in this configuration does not get issued a refresh token, which is now a warning"
    }
]
