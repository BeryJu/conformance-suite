[
    {
        "test-name": "fapi-ciba-ensure-authorization-request-with-potentially-bad-binding-message",
        "variant": "poll-mtls",
        "configuration-filename": "authlete-fapi-ciba-mtls-poll.json",
        "current-block": "Resource server endpoint tests",
        "condition": "ExpectBindingMessageCorrectDisplay",
        "expected-result": "failure"
    },
    {
        "test-name": "fapi-ciba-ensure-authorization-request-with-potentially-bad-binding-message",
        "variant": "ping-mtls",
        "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
        "current-block": "Resource server endpoint tests",
        "condition": "ExpectBindingMessageCorrectDisplay",
        "expected-result": "failure"
    },
    {
        "test-name": "fapi-ciba-ensure-authorization-request-with-potentially-bad-binding-message",
        "variant": "poll-private_key_jwt",
        "configuration-filename": "authlete-fapi-ciba-privatekey-poll.json",
        "current-block": "Resource server endpoint tests",
        "condition": "ExpectBindingMessageCorrectDisplay",
        "expected-result": "failure"
    },
    {
        "test-name": "fapi-ciba-ensure-authorization-request-with-potentially-bad-binding-message",
        "variant": "ping-private_key_jwt",
        "configuration-filename": "authlete-fapi-ciba-privatekey-ping-dcr.json",
        "current-block": "Resource server endpoint tests",
        "condition": "ExpectBindingMessageCorrectDisplay",
        "expected-result": "failure"
    },
    {
        "test-name": "fapi-ciba-ensure-authorization-request-with-potentially-bad-binding-message",
        "variant": "openbankinguk-poll-mtls",
        "configuration-filename": "authlete-fapi-ciba-mtls-poll.json",
        "current-block": "Resource server endpoint tests",
        "condition": "ExpectBindingMessageCorrectDisplay",
        "expected-result": "failure"
    },
    {
        "test-name": "fapi-ciba-ensure-authorization-request-with-potentially-bad-binding-message",
        "variant": "openbankinguk-ping-mtls",
        "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
        "current-block": "Resource server endpoint tests",
        "condition": "ExpectBindingMessageCorrectDisplay",
        "expected-result": "failure"
    },
    {
        "test-name": "fapi-ciba-ensure-authorization-request-with-potentially-bad-binding-message",
        "variant": "openbankinguk-poll-private_key_jwt",
        "configuration-filename": "authlete-fapi-ciba-privatekey-poll.json",
        "current-block": "Resource server endpoint tests",
        "condition": "ExpectBindingMessageCorrectDisplay",
        "expected-result": "failure"
    },
    {
        "test-name": "fapi-ciba-ensure-authorization-request-with-potentially-bad-binding-message",
        "variant": "openbankinguk-ping-private_key_jwt",
        "configuration-filename": "authlete-fapi-ciba-privatekey-ping-dcr.json",
        "current-block": "Resource server endpoint tests",
        "condition": "ExpectBindingMessageCorrectDisplay",
        "expected-result": "failure"
    },
    {
        "test-name": "fapi-ciba-ensure-without-client-assertion-in-backchannel-authorization-request",
        "variant": "poll-private_key_jwt",
        "configuration-filename": "authlete-fapi-ciba-privatekey-poll.json",
        "current-block": "Call backchannel authentication endpoint",
        "condition": "CheckBackchannelAuthenticationEndpointErrorHttpStatus",
        "expected-result": "failure",
        "comment": "This test returned the error that was invalid_client, but the http response status was 400"
    },
    {
        "test-name": "fapi-ciba-ensure-without-client-assertion-in-backchannel-authorization-request",
        "variant": "ping-private_key_jwt",
        "configuration-filename": "authlete-fapi-ciba-privatekey-ping-dcr.json",
        "current-block": "Call backchannel authentication endpoint",
        "condition": "CheckBackchannelAuthenticationEndpointErrorHttpStatus",
        "expected-result": "failure",
        "comment": "This test returned the error that was invalid_client, but the http response status was 400"
    },
    {
        "test-name": "fapi-ciba-ensure-without-client-assertion-in-backchannel-authorization-request",
        "variant": "openbankinguk-poll-private_key_jwt",
        "configuration-filename": "authlete-fapi-ciba-privatekey-poll.json",
        "current-block": "Call backchannel authentication endpoint",
        "condition": "CheckBackchannelAuthenticationEndpointErrorHttpStatus",
        "expected-result": "failure",
        "comment": "This test returned the error that was invalid_client, but the http response status was 400"
    },
    {
        "test-name": "fapi-ciba-ensure-without-client-assertion-in-backchannel-authorization-request",
        "variant": "openbankinguk-ping-private_key_jwt",
        "configuration-filename": "authlete-fapi-ciba-privatekey-ping-dcr.json",
        "current-block": "Call backchannel authentication endpoint",
        "condition": "CheckBackchannelAuthenticationEndpointErrorHttpStatus",
        "expected-result": "failure",
        "comment": "This test returned the error that was invalid_client, but the http response status was 400"
    },
    {
        "test-name": "fapi-ciba-ensure-client-assertion-signature-algorithm-in-backchannel-authorization-request-is-RS256-fails",
        "variant": "poll-private_key_jwt",
        "configuration-filename": "authlete-fapi-ciba-privatekey-poll.json",
        "current-block": "Call backchannel authentication endpoint",
        "condition": "CheckBackchannelAuthenticationEndpointErrorHttpStatus",
        "expected-result": "failure",
        "comment": "This test returned the error that was invalid_client, but the http response status was 400"
    },
    {
        "test-name": "fapi-ciba-ensure-client-assertion-signature-algorithm-in-backchannel-authorization-request-is-RS256-fails",
        "variant": "ping-private_key_jwt",
        "configuration-filename": "authlete-fapi-ciba-privatekey-ping-dcr.json",
        "current-block": "Call backchannel authentication endpoint",
        "condition": "CheckBackchannelAuthenticationEndpointErrorHttpStatus",
        "expected-result": "failure",
        "comment": "This test returned the error that was invalid_client, but the http response status was 400"
    },
    {
        "test-name": "fapi-ciba-ensure-client-assertion-signature-algorithm-in-backchannel-authorization-request-is-RS256-fails",
        "variant": "openbankinguk-poll-private_key_jwt",
        "configuration-filename": "authlete-fapi-ciba-privatekey-poll.json",
        "current-block": "Call backchannel authentication endpoint",
        "condition": "CheckBackchannelAuthenticationEndpointErrorHttpStatus",
        "expected-result": "failure",
        "comment": "This test returned the error that was invalid_client, but the http response status was 400"
    },
    {
        "test-name": "fapi-ciba-ensure-client-assertion-signature-algorithm-in-backchannel-authorization-request-is-RS256-fails",
        "variant": "openbankinguk-ping-private_key_jwt",
        "configuration-filename": "authlete-fapi-ciba-privatekey-ping-dcr.json",
        "current-block": "Call backchannel authentication endpoint",
        "condition": "CheckBackchannelAuthenticationEndpointErrorHttpStatus",
        "expected-result": "failure",
        "comment": "This test returned the error that was invalid_client, but the http response status was 400"
    },
    {
        "test-name": "fapi-ciba-ensure-without-client-assertion-in-token-endpoint-request",
        "variant": "poll-private_key_jwt",
        "configuration-filename": "authlete-fapi-ciba-privatekey-poll.json",
        "current-block": "Call backchannel authentication endpoint",
        "condition": "CheckTokenEndpointHttpStatus401Or400",
        "expected-result": "failure",
        "comment": "This test should end with the token endpoint returning an error message that the client is invalid, but now it returned the error that is invalid_request"
    },
    {
        "test-name": "fapi-ciba-ensure-without-client-assertion-in-token-endpoint-request",
        "variant": "ping-private_key_jwt",
        "configuration-filename": "authlete-fapi-ciba-privatekey-ping-dcr.json",
        "current-block": "Call backchannel authentication endpoint",
        "condition": "CheckTokenEndpointHttpStatus401Or400",
        "expected-result": "failure",
        "comment": "This test should end with the token endpoint returning an error message that the client is invalid, but now it returned the error that is invalid_request"
    },
    {
        "test-name": "fapi-ciba-ensure-without-client-assertion-in-token-endpoint-request",
        "variant": "openbankinguk-poll-private_key_jwt",
        "configuration-filename": "authlete-fapi-ciba-privatekey-poll.json",
        "current-block": "Call backchannel authentication endpoint",
        "condition": "CheckTokenEndpointHttpStatus401Or400",
        "expected-result": "failure",
        "comment": "This test should end with the token endpoint returning an error message that the client is invalid, but now it returned the error that is invalid_request"
    },
    {
        "test-name": "fapi-ciba-ensure-without-client-assertion-in-token-endpoint-request",
        "variant": "openbankinguk-ping-private_key_jwt",
        "configuration-filename": "authlete-fapi-ciba-privatekey-ping-dcr.json",
        "current-block": "Call backchannel authentication endpoint",
        "condition": "CheckTokenEndpointHttpStatus401Or400",
        "expected-result": "failure",
        "comment": "This test should end with the token endpoint returning an error message that the client is invalid, but now it returned the error that is invalid_request"
    },
    {
        "test-name": "fapi-rw-id2-ob-discovery-end-point-verification",
        "configuration-filename": "authlete-fapi-rw-id2-ob-mtls.json",
        "current-block": "",
        "condition": "CheckJwksUriIsHostedOnOpenBankingDirectory",
        "expected-result": "warning"
    },
    {
        "test-name": "fapi-rw-id2-ob-with-mtls",
        "configuration-filename": "authlete-fapi-rw-id2-ob-mtls.json",
        "current-block": "Attempting reuse of client2's authorisation code & testing if access token is revoked",
        "condition": "CallProtectedResourceWithBearerTokenExpectingError",
        "expected-result": "warning"
    },
    {
        "test-name": "fapi-rw-id2-ob-ensure-server-handles-non-matching-intent-id-with-mtls",
        "configuration-filename": "authlete-fapi-rw-id2-ob-mtls.json",
        "current-block": "Verify authorization endpoint response",
        "condition": "ValidateErrorResponseFromAuthorizationEndpoint",
        "expected-result": "failure"
    },
    {
        "test-name": "fapi-rw-id2-ob-ensure-server-handles-non-matching-intent-id-with-mtls",
        "configuration-filename": "authlete-fapi-rw-id2-ob-mtls.json",
        "current-block": "Verify authorization endpoint response",
        "condition": "EnsureInvalidRequestInvalidRequestObjectOrAccessDeniedError",
        "expected-result": "failure"
    },
    {
        "test-name": "fapi-rw-id2-ob-ensure-request-object-with-multiple-aud-succeeds-with-mtls",
        "configuration-filename": "authlete-fapi-rw-id2-ob-mtls.json",
        "current-block": "Attempting reuse of client2's authorisation code & testing if access token is revoked",
        "condition": "CallProtectedResourceWithBearerTokenExpectingError",
        "expected-result": "warning"
    },
    {
        "test-name": "fapi-rw-id2-ob-discovery-end-point-verification",
        "configuration-filename": "authlete-fapi-rw-id2-ob-privatekey.json",
        "current-block": "",
        "condition": "CheckJwksUriIsHostedOnOpenBankingDirectory",
        "expected-result": "warning"
    },
    {
        "test-name": "fapi-rw-id2-ob-with-private-key-and-mtls-holder-of-key",
        "configuration-filename": "authlete-fapi-rw-id2-ob-privatekey.json",
        "current-block": "Attempting reuse of client2's authorisation code & testing if access token is revoked",
        "condition": "CallProtectedResourceWithBearerTokenExpectingError",
        "expected-result": "warning"
    },
    {
        "test-name": "fapi-rw-id2-ob-ensure-server-handles-non-matching-intent-id-with-private-key-and-mtls-holder-of-key",
        "configuration-filename": "authlete-fapi-rw-id2-ob-privatekey.json",
        "current-block": "Verify authorization endpoint response",
        "condition": "ValidateErrorResponseFromAuthorizationEndpoint",
        "expected-result": "failure"
    },
    {
        "test-name": "fapi-rw-id2-ob-ensure-server-handles-non-matching-intent-id-with-private-key-and-mtls-holder-of-key",
        "configuration-filename": "authlete-fapi-rw-id2-ob-privatekey.json",
        "current-block": "Verify authorization endpoint response",
        "condition": "EnsureInvalidRequestInvalidRequestObjectOrAccessDeniedError",
        "expected-result": "failure"
    },
    {
        "test-name": "fapi-rw-id2-ob-ensure-request-object-with-multiple-aud-succeeds-with-private-key-and-mtls-holder-of-key",
        "configuration-filename": "authlete-fapi-rw-id2-ob-privatekey.json",
        "current-block": "Attempting reuse of client2's authorisation code & testing if access token is revoked",
        "condition": "CallProtectedResourceWithBearerTokenExpectingError",
        "expected-result": "warning"
    },
    {
        "test-name": "fapi-rw-id2-with-mtls",
        "configuration-filename": "authlete-fapi-rw-id2-mtls.json",
        "current-block": "Attempting reuse of client2's authorisation code & testing if access token is revoked",
        "condition": "CallProtectedResourceWithBearerTokenExpectingError",
        "expected-result": "warning"
    },
    {
        "test-name": "fapi-rw-id2-ensure-request-object-with-multiple-aud-succeeds-with-mtls",
        "configuration-filename": "authlete-fapi-rw-id2-mtls.json",
        "current-block": "Attempting reuse of client2's authorisation code & testing if access token is revoked",
        "condition": "CallProtectedResourceWithBearerTokenExpectingError",
        "expected-result": "warning"
    },
    {
        "test-name": "fapi-rw-id2-with-private-key-and-mtls-holder-of-key",
        "configuration-filename": "authlete-fapi-rw-id2-privatekey.json",
        "current-block": "Attempting reuse of client2's authorisation code & testing if access token is revoked",
        "condition": "CallProtectedResourceWithBearerTokenExpectingError",
        "expected-result": "warning"
    },
    {
        "test-name": "fapi-rw-id2-ensure-request-object-with-multiple-aud-succeeds-with-private-key-and-mtls-holder-of-key",
        "configuration-filename": "authlete-fapi-rw-id2-privatekey.json",
        "current-block": "Attempting reuse of client2's authorisation code & testing if access token is revoked",
        "condition": "CallProtectedResourceWithBearerTokenExpectingError",
        "expected-result": "warning"
    },
    {
        "test-name": "fapi-rw-id2-with-private-key-and-mtls-holder-of-key",
        "configuration-filename": "authlete-fapi-rw-id2-privatekey-for-instructions.json",
        "current-block": "Attempting reuse of client2's authorisation code & testing if access token is revoked",
        "condition": "CallProtectedResourceWithBearerTokenExpectingError",
        "expected-result": "warning"
    },
    {
        "test-name": "fapi-rw-id2-ensure-request-object-with-multiple-aud-succeeds-with-private-key-and-mtls-holder-of-key",
        "configuration-filename": "authlete-fapi-rw-id2-privatekey-for-instructions.json",
        "current-block": "Attempting reuse of client2's authorisation code & testing if access token is revoked",
        "condition": "CallProtectedResourceWithBearerTokenExpectingError",
        "expected-result": "warning"
    },
    {
        "test-name": "fapi-rw-id2-ensure-client-assertion-in-token-endpoint-with-private-key-and-mtls-holder-of-key",
        "configuration-filename": "authlete-fapi-rw-id2-privatekey.json",
        "current-block": "Verify authorization endpoint response",
        "condition": "CheckTokenEndpointHttpStatus401Or400",
        "expected-result": "failure",
        "comment": "This test returned the error that was invalid_request, but the http response status was 401"
    },
    {
        "test-name": "fapi-rw-id2-ensure-client-assertion-in-token-endpoint-with-private-key-and-mtls-holder-of-key",
        "configuration-filename": "authlete-fapi-rw-id2-privatekey-for-instructions.json",
        "current-block": "Verify authorization endpoint response",
        "condition": "CheckTokenEndpointHttpStatus401Or400",
        "expected-result": "failure",
        "comment": "This test returned the error that was invalid_request, but the http response status was 401"
    },
    {
        "test-name": "fapi-rw-id2-ob-ensure-client-assertion-in-token-endpoint-with-private-key-and-mtls-holder-of-key",
        "configuration-filename": "authlete-fapi-rw-id2-ob-privatekey.json",
        "current-block": "Verify authorization endpoint response",
        "condition": "CheckTokenEndpointHttpStatus401Or400",
        "expected-result": "failure",
        "comment": "This test returned the error that was invalid_request, but the http response status was 401"
    }
]
