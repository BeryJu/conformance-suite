[
  {
    "test-name": "fapi-ciba-poll-with-mtls",
    "configuration-filename": "authlete-fapi-ciba-mtls-poll.json",
    "current-block": "Attempting reuse of client2's auth_req_id (which should fail) then testing if access token is revoked",
    "condition": "CallAccountsEndpointWithBearerTokenExpectingError",
    "expected-result": "warning"
  },
  {
    "test-name": "fapi-ciba-ping-with-mtls",
    "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
    "current-block": "Attempting reuse of client2's auth_req_id (which should fail) then testing if access token is revoked",
    "condition": "CallAccountsEndpointWithBearerTokenExpectingError",
    "expected-result": "warning"
  },
  {
    "test-name": "fapi-ciba-ping-with-mtls",
    "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
    "current-block": "Verify notification callback",
    "condition": "EnsureIncomingTlsSecureCipher",
    "comment": "known about; Authlete haven't implemented FAPI-CIBA yet",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ping-with-mtls-backchannel-notification-endpoint-response-has-body",
    "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
    "current-block": "Verify notification callback",
    "condition": "EnsureIncomingTlsSecureCipher",
    "expected-result": "failure",
    "comment": "known about; Authlete haven't implemented FAPI-CIBA yet"
  },
  {
    "test-name": "fapi-ciba-ping-with-mtls-backchannel-notification-endpoint-response-401",
    "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
    "current-block": "Verify notification callback",
    "condition": "EnsureIncomingTlsSecureCipher",
    "expected-result": "failure",
    "comment": "known about; Authlete haven't implemented FAPI-CIBA yet"
  },
  {
    "test-name": "fapi-ciba-ping-with-mtls-backchannel-notification-endpoint-response-403",
    "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
    "current-block": "Verify notification callback",
    "condition": "EnsureIncomingTlsSecureCipher",
    "expected-result": "failure",
    "comment": "known about; Authlete haven't implemented FAPI-CIBA yet"
  },
  {
    "test-name": "fapi-ciba-ping-with-mtls",
    "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
    "current-block": "Second client: Verify notification callback",
    "condition": "EnsureIncomingTlsSecureCipher",
    "comment": "known about; Authlete haven't implemented FAPI-CIBA yet",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ping-with-mtls-ensure-request-object-exp-is-year-in-future-fails",
    "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "CIBANotificationEndpointCalledUnexpectedly",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ping-with-mtls-ensure-request-object-iat-is-week-in-past-fails",
    "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "CIBANotificationEndpointCalledUnexpectedly",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ping-ensure-backchannel-authorization-request-without-request-fails-with-mtls",
    "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "CIBANotificationEndpointCalledUnexpectedly",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ping-ensure-wrong-client-id-in-token-endpoint-request-with-mtls",
    "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
    "current-block": "Swapping to Client2 and calling token endpoint",
    "condition": "CIBANotificationEndpointCalledUnexpectedly",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ping-ensure-wrong-auth-req-id-in-token-endpoint-request-with-mtls",
    "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
    "current-block": "Swapping to Client2, Jwks2, tls2 and calling token endpoint",
    "condition": "CIBANotificationEndpointCalledUnexpectedly",
    "expected-result": "failure"
  },
  {
    "test-name":"fapi-ciba-ping-ensure-authorization-request-with-binding-message-succeeds-with-mtls",
    "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
    "current-block": "Second client: Verify notification callback",
    "condition": "EnsureIncomingTlsSecureCipher",
    "comment": "known about; Authlete haven't implemented FAPI-CIBA yet",
    "expected-result": "failure"
  },
  {
    "test-name":"fapi-ciba-ping-ensure-authorization-request-with-potentially-bad-binding-message-with-mtls",
    "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
    "current-block": "Second client: Verify notification callback",
    "condition": "EnsureIncomingTlsSecureCipher",
    "comment": "known about; Authlete haven't implemented FAPI-CIBA yet",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ping-user-rejects-authentication-with-mtls",
    "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
    "current-block": "Verify notification callback",
    "condition": "EnsureIncomingTlsSecureCipher",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ping-auth-req-id-expired-with-mtls",
    "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
    "current-block": "Verify notification callback",
    "condition": "EnsureIncomingTlsSecureCipher",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-poll-with-mtls-ensure-request-object-exp-is-year-in-future-fails",
    "configuration-filename": "authlete-fapi-ciba-mtls-poll.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "ValidateErrorResponseFromBackchannelAuthenticationEndpoint",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-poll-with-mtls-ensure-request-object-exp-is-year-in-future-fails",
    "configuration-filename": "authlete-fapi-ciba-mtls-poll.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "CheckBackchannelAuthenticationEndpointHttpStatus400",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-poll-with-mtls-ensure-request-object-exp-is-year-in-future-fails",
    "configuration-filename": "authlete-fapi-ciba-mtls-poll.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "CheckErrorFromBackchannelAuthenticationEndpointErrorInvalidRequest",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ping-with-mtls-ensure-request-object-exp-is-year-in-future-fails",
    "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "ValidateErrorResponseFromBackchannelAuthenticationEndpoint",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ping-with-mtls-ensure-request-object-exp-is-year-in-future-fails",
    "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "CheckBackchannelAuthenticationEndpointHttpStatus400",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ping-with-mtls-ensure-request-object-exp-is-year-in-future-fails",
    "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "CheckErrorFromBackchannelAuthenticationEndpointErrorInvalidRequest",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ping-with-mtls-ensure-request-object-exp-is-year-in-future-fails",
    "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "TEST-RUNNER",
    "comment": "known issue; authlete accepts request okay, conformance suite is not waiting for ping response",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-poll-with-mtls-ensure-request-object-iat-is-week-in-past-fails",
    "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "TEST-RUNNER",
    "comment": "known issue; authlete accepts request okay, conformance suite is not waiting for ping response",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-poll-with-mtls-ensure-request-object-iat-is-week-in-past-fails",
    "configuration-filename": "authlete-fapi-ciba-mtls-poll.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "ValidateErrorResponseFromBackchannelAuthenticationEndpoint",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-poll-with-mtls-ensure-request-object-iat-is-week-in-past-fails",
    "configuration-filename": "authlete-fapi-ciba-mtls-poll.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "CheckBackchannelAuthenticationEndpointHttpStatus400",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-poll-with-mtls-ensure-request-object-iat-is-week-in-past-fails",
    "configuration-filename": "authlete-fapi-ciba-mtls-poll.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "CheckErrorFromBackchannelAuthenticationEndpointErrorInvalidRequest",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ping-with-mtls-ensure-request-object-iat-is-week-in-past-fails",
    "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "ValidateErrorResponseFromBackchannelAuthenticationEndpoint",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ping-with-mtls-ensure-request-object-iat-is-week-in-past-fails",
    "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "CheckBackchannelAuthenticationEndpointHttpStatus400",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ping-with-mtls-ensure-request-object-iat-is-week-in-past-fails",
    "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "CheckErrorFromBackchannelAuthenticationEndpointErrorInvalidRequest",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ping-with-mtls-ensure-request-object-iat-is-week-in-past-fails",
    "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "TEST-RUNNER",
    "comment": "Known issue with conformance suite not waiting for ping if back auth request succeeds",
    "expected-result": "failure"
  },
  {
    "test-name":"fapi-ciba-ping-ensure-backchannel-authorization-request-without-request-fails-with-mtls",
    "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "TEST-RUNNER",
    "comment": "Known issue with conformance suite not waiting for ping if back auth request succeeds",
    "expected-result": "failure"
  },
  {
    "test-name":"fapi-ciba-ping-ensure-wrong-client-id-in-token-endpoint-request-with-mtls",
    "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
    "current-block": "Swapping to Client2 and calling token endpoint",
    "condition": "TEST-RUNNER",
    "comment": "Known issue with conformance suite not waiting for ping if back auth request succeeds",
    "expected-result": "failure"
  },
  {
    "test-name":"fapi-ciba-ping-ensure-wrong-auth-req-id-in-token-endpoint-request-with-mtls",
    "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
    "current-block": "Swapping to Client2, Jwks2, tls2 and calling token endpoint",
    "condition": "TEST-RUNNER",
    "comment": "Known issue with conformance suite not waiting for ping if back auth request succeeds",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-poll-ensure-authorization-request-with-binding-message-succeeds",
    "configuration-filename": "authlete-fapi-ciba-privatekey-poll.json",
    "current-block": "Attempting reuse of client2's auth_req_id (which should fail) then testing if access token is revoked",
    "condition": "CallAccountsEndpointWithBearerTokenExpectingError",
    "expected-result": "warning"
  },
  {
    "test-name": "fapi-ciba-ping-ensure-authorization-request-with-binding-message-succeeds-with-mtls",
    "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
    "current-block": "Attempting reuse of client2's auth_req_id (which should fail) then testing if access token is revoked",
    "condition": "CallAccountsEndpointWithBearerTokenExpectingError",
    "expected-result": "warning"
  },
  {
    "test-name": "fapi-ciba-ping-ensure-authorization-request-with-binding-message-succeeds-with-mtls",
    "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
    "current-block": "Verify notification callback",
    "condition": "EnsureIncomingTlsSecureCipher",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-poll-ensure-authorization-request-with-potentially-bad-binding-message-with-mtls",
    "configuration-filename": "authlete-fapi-ciba-mtls-poll.json",
    "current-block": "Resource server endpoint tests",
    "condition": "ExpectBindingMessageCorrectDisplay",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ping-ensure-authorization-request-with-potentially-bad-binding-message-with-mtls",
    "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
    "current-block": "Resource server endpoint tests",
    "condition": "ExpectBindingMessageCorrectDisplay",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ping-ensure-authorization-request-with-potentially-bad-binding-message-with-mtls",
    "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
    "current-block": "Verify notification callback",
    "condition": "EnsureIncomingTlsSecureCipher",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-poll-ensure-backchannel-authorization-request-without-request-fails-with-mtls",
    "configuration-filename": "authlete-fapi-ciba-mtls-poll.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "ValidateErrorResponseFromBackchannelAuthenticationEndpoint",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-poll-ensure-backchannel-authorization-request-without-request-fails-with-mtls",
    "configuration-filename": "authlete-fapi-ciba-mtls-poll.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "CheckBackchannelAuthenticationEndpointHttpStatus400",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-poll-ensure-backchannel-authorization-request-without-request-fails-with-mtls",
    "configuration-filename": "authlete-fapi-ciba-mtls-poll.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "CheckErrorFromBackchannelAuthenticationEndpointErrorInvalidRequest",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ping-ensure-backchannel-authorization-request-without-request-fails-with-mtls",
    "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "ValidateErrorResponseFromBackchannelAuthenticationEndpoint",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ping-ensure-backchannel-authorization-request-without-request-fails-with-mtls",
    "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "CheckBackchannelAuthenticationEndpointHttpStatus400",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ping-ensure-backchannel-authorization-request-without-request-fails-with-mtls",
    "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "CheckErrorFromBackchannelAuthenticationEndpointErrorInvalidRequest",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-poll",
    "configuration-filename": "authlete-fapi-ciba-privatekey-poll.json",
    "current-block": "Attempting reuse of client2's auth_req_id (which should fail) then testing if access token is revoked",
    "condition": "CallAccountsEndpointWithBearerTokenExpectingError",
    "expected-result": "warning"
  },
  {
    "test-name": "fapi-rw-id2-ob-discovery-end-point-verification",
    "configuration-filename": "authlete-fapi-rw-id2-ob-mtls.json",
    "current-block": "",
    "condition": "CheckJwksUriIsHostedOnOpenBankingDirectory",
    "expected-result": "warning"
  },
  {
    "test-name": "fapi-rw-id2-ob-with-mtls",
    "configuration-filename": "authlete-fapi-rw-id2-ob-mtls.json",
    "current-block": "Attempting reuse of client2's authorisation code & testing if access token is revoked",
    "condition": "CallAccountsEndpointWithBearerTokenExpectingError",
    "expected-result": "warning"
  },
  {
    "test-name": "fapi-rw-id2-ob-ensure-server-handles-non-matching-intent-id-with-mtls",
    "configuration-filename": "authlete-fapi-rw-id2-ob-mtls.json",
    "current-block": "Verify authorization endpoint response",
    "condition": "ValidateErrorResponseFromAuthorizationEndpoint",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-rw-id2-ob-ensure-server-handles-non-matching-intent-id-with-mtls",
    "configuration-filename": "authlete-fapi-rw-id2-ob-mtls.json",
    "current-block": "Verify authorization endpoint response",
    "condition": "EnsureInvalidRequestInvalidRequestObjectOrAccessDeniedError",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-rw-id2-ob-ensure-request-object-with-multiple-aud-succeeds-with-mtls",
    "configuration-filename": "authlete-fapi-rw-id2-ob-mtls.json",
    "current-block": "Attempting reuse of client2's authorisation code & testing if access token is revoked",
    "condition": "CallAccountsEndpointWithBearerTokenExpectingError",
    "expected-result": "warning"
  },
  {
    "test-name": "fapi-rw-id2-ob-discovery-end-point-verification",
    "configuration-filename": "authlete-fapi-rw-id2-ob-privatekey.json",
    "current-block": "",
    "condition": "CheckJwksUriIsHostedOnOpenBankingDirectory",
    "expected-result": "warning"
  },
  {
    "test-name": "fapi-rw-id2-ob-with-private-key-and-mtls-holder-of-key",
    "configuration-filename": "authlete-fapi-rw-id2-ob-privatekey.json",
    "current-block": "Attempting reuse of client2's authorisation code & testing if access token is revoked",
    "condition": "CallAccountsEndpointWithBearerTokenExpectingError",
    "expected-result": "warning"
  },
  {
    "test-name": "fapi-rw-id2-ob-ensure-server-handles-non-matching-intent-id-with-private-key-and-mtls-holder-of-key",
    "configuration-filename": "authlete-fapi-rw-id2-ob-privatekey.json",
    "current-block": "Verify authorization endpoint response",
    "condition": "ValidateErrorResponseFromAuthorizationEndpoint",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-rw-id2-ob-ensure-server-handles-non-matching-intent-id-with-private-key-and-mtls-holder-of-key",
    "configuration-filename": "authlete-fapi-rw-id2-ob-privatekey.json",
    "current-block": "Verify authorization endpoint response",
    "condition": "EnsureInvalidRequestInvalidRequestObjectOrAccessDeniedError",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-rw-id2-ob-ensure-request-object-with-multiple-aud-succeeds-with-private-key-and-mtls-holder-of-key",
    "configuration-filename": "authlete-fapi-rw-id2-ob-privatekey.json",
    "current-block": "Attempting reuse of client2's authorisation code & testing if access token is revoked",
    "condition": "CallAccountsEndpointWithBearerTokenExpectingError",
    "expected-result": "warning"
  },
  {
    "test-name": "fapi-rw-id2-with-mtls",
    "configuration-filename": "authlete-fapi-rw-id2-mtls.json",
    "current-block": "Attempting reuse of client2's authorisation code & testing if access token is revoked",
    "condition": "CallAccountsEndpointWithBearerTokenExpectingError",
    "expected-result": "warning"
  },
  {
    "test-name": "fapi-rw-id2-ensure-request-object-with-multiple-aud-succeeds-with-mtls",
    "configuration-filename": "authlete-fapi-rw-id2-mtls.json",
    "current-block": "Attempting reuse of client2's authorisation code & testing if access token is revoked",
    "condition": "CallAccountsEndpointWithBearerTokenExpectingError",
    "expected-result": "warning"
  },
  {
    "test-name": "fapi-rw-id2-with-private-key-and-mtls-holder-of-key",
    "configuration-filename": "authlete-fapi-rw-id2-privatekey.json",
    "current-block": "Attempting reuse of client2's authorisation code & testing if access token is revoked",
    "condition": "CallAccountsEndpointWithBearerTokenExpectingError",
    "expected-result": "warning"
  },
  {
    "test-name": "fapi-rw-id2-ensure-request-object-with-multiple-aud-succeeds-with-private-key-and-mtls-holder-of-key",
    "configuration-filename": "authlete-fapi-rw-id2-privatekey.json",
    "current-block": "Attempting reuse of client2's authorisation code & testing if access token is revoked",
    "condition": "CallAccountsEndpointWithBearerTokenExpectingError",
    "expected-result": "warning"
  },
  {
    "test-name": "fapi-rw-id2-with-private-key-and-mtls-holder-of-key",
    "configuration-filename": "authlete-fapi-rw-id2-privatekey-for-instructions.json",
    "current-block": "Attempting reuse of client2's authorisation code & testing if access token is revoked",
    "condition": "CallAccountsEndpointWithBearerTokenExpectingError",
    "expected-result": "warning"
  },
  {
    "test-name": "fapi-rw-id2-with-private-key-and-mtls-holder-of-key",
    "configuration-filename": "authlete-fapi-rw-id2-privatekey-for-instructions.json",
    "current-block": "Attempting reuse of client2's authorisation code & testing if access token is revoked",
    "condition": "CallAccountsEndpointWithBearerTokenExpectingError",
    "expected-result": "warning"
  },
  {
    "test-name": "fapi-rw-id2-ensure-request-object-with-multiple-aud-succeeds-with-private-key-and-mtls-holder-of-key",
    "configuration-filename": "authlete-fapi-rw-id2-privatekey-for-instructions.json",
    "current-block": "Attempting reuse of client2's authorisation code & testing if access token is revoked",
    "condition": "CallAccountsEndpointWithBearerTokenExpectingError",
    "expected-result": "warning"
  }
]
