[
  {
    "test-name": "fapi-ciba",
    "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
    "current-block": "Attempting reuse of client2's auth_req_id (which should fail) then testing if access token is revoked",
    "condition": "CallAccountsEndpointWithBearerTokenExpectingError",
    "expected-result": "warning"
  },
  {
    "test-name": "fapi-ciba-ping-with-mtls-ensure-request-object-exp-is-year-in-future-fails",
    "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "CIBANotificationEndpointCalledUnexpectedly",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ping-with-mtls-ensure-request-object-iat-is-week-in-past-fails",
    "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "CIBANotificationEndpointCalledUnexpectedly",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba",
    "configuration-filename": "authlete-fapi-ciba-mtls-poll.json",
    "current-block": "Attempting reuse of client2's auth_req_id (which should fail) then testing if access token is revoked",
    "condition": "CallAccountsEndpointWithBearerTokenExpectingError",
    "expected-result": "warning"
  },
  {
    "test-name": "fapi-ciba-poll-ensure-authorization-request-with-binding-message-succeeds",
    "configuration-filename": "authlete-fapi-ciba-mtls-poll.json",
    "current-block": "Attempting reuse of client2's auth_req_id (which should fail) then testing if access token is revoked",
    "condition": "CallAccountsEndpointWithBearerTokenExpectingError",
    "expected-result": "warning"
  },
  {
    "test-name": "fapi-ciba-ensure-request-object-exp-is-year-in-future-fails",
    "configuration-filename": "authlete-fapi-ciba-mtls-poll.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "ValidateErrorResponseFromBackchannelAuthenticationEndpoint",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ensure-request-object-exp-is-year-in-future-fails",
    "configuration-filename": "authlete-fapi-ciba-mtls-poll.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "CheckBackchannelAuthenticationEndpointHttpStatus400",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ensure-request-object-exp-is-year-in-future-fails",
    "configuration-filename": "authlete-fapi-ciba-mtls-poll.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "CheckErrorFromBackchannelAuthenticationEndpointErrorInvalidRequest",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ensure-request-object-exp-is-year-in-future-fails",
    "configuration-filename": "authlete-fapi-ciba-privatekey-poll.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "ValidateErrorResponseFromBackchannelAuthenticationEndpoint",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ensure-request-object-exp-is-year-in-future-fails",
    "configuration-filename": "authlete-fapi-ciba-privatekey-poll.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "CheckBackchannelAuthenticationEndpointHttpStatus400",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ensure-request-object-exp-is-year-in-future-fails",
    "configuration-filename": "authlete-fapi-ciba-privatekey-poll.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "CheckErrorFromBackchannelAuthenticationEndpointErrorInvalidRequest",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ensure-request-object-exp-is-year-in-future-fails",
    "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "ValidateErrorResponseFromBackchannelAuthenticationEndpoint",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ensure-request-object-exp-is-year-in-future-fails",
    "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "CheckBackchannelAuthenticationEndpointHttpStatus400",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ensure-request-object-exp-is-year-in-future-fails",
    "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "CheckErrorFromBackchannelAuthenticationEndpointErrorInvalidRequest",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ensure-request-object-exp-is-year-in-future-fails",
    "configuration-filename": "authlete-fapi-ciba-privatekey-ping-dcr.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "ValidateErrorResponseFromBackchannelAuthenticationEndpoint",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ensure-request-object-exp-is-year-in-future-fails",
    "configuration-filename": "authlete-fapi-ciba-privatekey-ping-dcr.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "CheckBackchannelAuthenticationEndpointHttpStatus400",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ensure-request-object-exp-is-year-in-future-fails",
    "configuration-filename": "authlete-fapi-ciba-privatekey-ping-dcr.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "CheckErrorFromBackchannelAuthenticationEndpointErrorInvalidRequest",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ensure-request-object-iat-is-week-in-past-fails",
    "configuration-filename": "authlete-fapi-ciba-mtls-poll.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "ValidateErrorResponseFromBackchannelAuthenticationEndpoint",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ensure-request-object-iat-is-week-in-past-fails",
    "configuration-filename": "authlete-fapi-ciba-mtls-poll.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "CheckBackchannelAuthenticationEndpointHttpStatus400",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ensure-request-object-iat-is-week-in-past-fails",
    "configuration-filename": "authlete-fapi-ciba-mtls-poll.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "CheckErrorFromBackchannelAuthenticationEndpointErrorInvalidRequest",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ensure-request-object-iat-is-week-in-past-fails",
    "configuration-filename": "authlete-fapi-ciba-privatekey-poll.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "ValidateErrorResponseFromBackchannelAuthenticationEndpoint",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ensure-request-object-iat-is-week-in-past-fails",
    "configuration-filename": "authlete-fapi-ciba-privatekey-poll.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "CheckBackchannelAuthenticationEndpointHttpStatus400",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ensure-request-object-iat-is-week-in-past-fails",
    "configuration-filename": "authlete-fapi-ciba-privatekey-poll.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "CheckErrorFromBackchannelAuthenticationEndpointErrorInvalidRequest",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ensure-request-object-iat-is-week-in-past-fails",
    "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "ValidateErrorResponseFromBackchannelAuthenticationEndpoint",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ensure-request-object-iat-is-week-in-past-fails",
    "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "CheckBackchannelAuthenticationEndpointHttpStatus400",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ensure-request-object-iat-is-week-in-past-fails",
    "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "CheckErrorFromBackchannelAuthenticationEndpointErrorInvalidRequest",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ensure-request-object-iat-is-week-in-past-fails",
    "configuration-filename": "authlete-fapi-ciba-privatekey-ping-dcr.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "ValidateErrorResponseFromBackchannelAuthenticationEndpoint",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ensure-request-object-iat-is-week-in-past-fails",
    "configuration-filename": "authlete-fapi-ciba-privatekey-ping-dcr.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "CheckBackchannelAuthenticationEndpointHttpStatus400",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ensure-request-object-iat-is-week-in-past-fails",
    "configuration-filename": "authlete-fapi-ciba-privatekey-ping-dcr.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "CheckErrorFromBackchannelAuthenticationEndpointErrorInvalidRequest",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba",
    "configuration-filename": "authlete-fapi-ciba-privatekey-poll.json",
    "current-block": "Attempting reuse of client2's auth_req_id (which should fail) then testing if access token is revoked",
    "condition": "CallAccountsEndpointWithBearerTokenExpectingError",
    "expected-result": "warning"
  },
  {
    "test-name": "fapi-ciba-poll-ensure-authorization-request-with-binding-message-succeeds",
    "configuration-filename": "authlete-fapi-ciba-privatekey-poll.json",
    "current-block": "Attempting reuse of client2's auth_req_id (which should fail) then testing if access token is revoked",
    "condition": "CallAccountsEndpointWithBearerTokenExpectingError",
    "expected-result": "warning"
  },
  {
    "test-name": "fapi-ciba-ping-ensure-authorization-request-with-binding-message-succeeds-with-mtls",
    "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
    "current-block": "Attempting reuse of client2's auth_req_id (which should fail) then testing if access token is revoked",
    "condition": "CallAccountsEndpointWithBearerTokenExpectingError",
    "expected-result": "warning"
  },
  {
    "test-name": "fapi-ciba-ensure-authorization-request-with-potentially-bad-binding-message",
    "configuration-filename": "authlete-fapi-ciba-mtls-poll.json",
    "current-block": "Resource server endpoint tests",
    "condition": "ExpectBindingMessageCorrectDisplay",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ensure-authorization-request-with-potentially-bad-binding-message",
    "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
    "current-block": "Resource server endpoint tests",
    "condition": "ExpectBindingMessageCorrectDisplay",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ensure-authorization-request-with-potentially-bad-binding-message",
    "configuration-filename": "authlete-fapi-ciba-privatekey-poll.json",
    "current-block": "Resource server endpoint tests",
    "condition": "ExpectBindingMessageCorrectDisplay",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ensure-authorization-request-with-potentially-bad-binding-message",
    "configuration-filename": "authlete-fapi-ciba-privatekey-ping-dcr.json",
    "current-block": "Resource server endpoint tests",
    "condition": "ExpectBindingMessageCorrectDisplay",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-poll-ensure-backchannel-authorization-request-without-request-fails-with-mtls",
    "configuration-filename": "authlete-fapi-ciba-mtls-poll.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "ValidateErrorResponseFromBackchannelAuthenticationEndpoint",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-poll-ensure-backchannel-authorization-request-without-request-fails-with-mtls",
    "configuration-filename": "authlete-fapi-ciba-mtls-poll.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "CheckBackchannelAuthenticationEndpointHttpStatus400",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-poll-ensure-backchannel-authorization-request-without-request-fails-with-mtls",
    "configuration-filename": "authlete-fapi-ciba-mtls-poll.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "CheckErrorFromBackchannelAuthenticationEndpointErrorInvalidRequest",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ping-ensure-backchannel-authorization-request-without-request-fails-with-mtls",
    "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "ValidateErrorResponseFromBackchannelAuthenticationEndpoint",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ping-ensure-backchannel-authorization-request-without-request-fails-with-mtls",
    "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "CheckBackchannelAuthenticationEndpointHttpStatus400",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-ciba-ping-ensure-backchannel-authorization-request-without-request-fails-with-mtls",
    "configuration-filename": "authlete-fapi-ciba-mtls-ping-dcr.json",
    "current-block": "Call backchannel authentication endpoint",
    "condition": "CheckErrorFromBackchannelAuthenticationEndpointErrorInvalidRequest",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-rw-id2-ob-discovery-end-point-verification",
    "configuration-filename": "authlete-fapi-rw-id2-ob-mtls.json",
    "current-block": "",
    "condition": "CheckJwksUriIsHostedOnOpenBankingDirectory",
    "expected-result": "warning"
  },
  {
    "test-name": "fapi-rw-id2-ob-with-mtls",
    "configuration-filename": "authlete-fapi-rw-id2-ob-mtls.json",
    "current-block": "Attempting reuse of client2's authorisation code & testing if access token is revoked",
    "condition": "CallAccountsEndpointWithBearerTokenExpectingError",
    "expected-result": "warning"
  },
  {
    "test-name": "fapi-rw-id2-ob-ensure-server-handles-non-matching-intent-id-with-mtls",
    "configuration-filename": "authlete-fapi-rw-id2-ob-mtls.json",
    "current-block": "Verify authorization endpoint response",
    "condition": "ValidateErrorResponseFromAuthorizationEndpoint",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-rw-id2-ob-ensure-server-handles-non-matching-intent-id-with-mtls",
    "configuration-filename": "authlete-fapi-rw-id2-ob-mtls.json",
    "current-block": "Verify authorization endpoint response",
    "condition": "EnsureInvalidRequestInvalidRequestObjectOrAccessDeniedError",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-rw-id2-ob-ensure-request-object-with-multiple-aud-succeeds-with-mtls",
    "configuration-filename": "authlete-fapi-rw-id2-ob-mtls.json",
    "current-block": "Attempting reuse of client2's authorisation code & testing if access token is revoked",
    "condition": "CallAccountsEndpointWithBearerTokenExpectingError",
    "expected-result": "warning"
  },
  {
    "test-name": "fapi-rw-id2-ob-discovery-end-point-verification",
    "configuration-filename": "authlete-fapi-rw-id2-ob-privatekey.json",
    "current-block": "",
    "condition": "CheckJwksUriIsHostedOnOpenBankingDirectory",
    "expected-result": "warning"
  },
  {
    "test-name": "fapi-rw-id2-ob-with-private-key-and-mtls-holder-of-key",
    "configuration-filename": "authlete-fapi-rw-id2-ob-privatekey.json",
    "current-block": "Attempting reuse of client2's authorisation code & testing if access token is revoked",
    "condition": "CallAccountsEndpointWithBearerTokenExpectingError",
    "expected-result": "warning"
  },
  {
    "test-name": "fapi-rw-id2-ob-ensure-server-handles-non-matching-intent-id-with-private-key-and-mtls-holder-of-key",
    "configuration-filename": "authlete-fapi-rw-id2-ob-privatekey.json",
    "current-block": "Verify authorization endpoint response",
    "condition": "ValidateErrorResponseFromAuthorizationEndpoint",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-rw-id2-ob-ensure-server-handles-non-matching-intent-id-with-private-key-and-mtls-holder-of-key",
    "configuration-filename": "authlete-fapi-rw-id2-ob-privatekey.json",
    "current-block": "Verify authorization endpoint response",
    "condition": "EnsureInvalidRequestInvalidRequestObjectOrAccessDeniedError",
    "expected-result": "failure"
  },
  {
    "test-name": "fapi-rw-id2-ob-ensure-request-object-with-multiple-aud-succeeds-with-private-key-and-mtls-holder-of-key",
    "configuration-filename": "authlete-fapi-rw-id2-ob-privatekey.json",
    "current-block": "Attempting reuse of client2's authorisation code & testing if access token is revoked",
    "condition": "CallAccountsEndpointWithBearerTokenExpectingError",
    "expected-result": "warning"
  },
  {
    "test-name": "fapi-rw-id2-with-mtls",
    "configuration-filename": "authlete-fapi-rw-id2-mtls.json",
    "current-block": "Attempting reuse of client2's authorisation code & testing if access token is revoked",
    "condition": "CallAccountsEndpointWithBearerTokenExpectingError",
    "expected-result": "warning"
  },
  {
    "test-name": "fapi-rw-id2-ensure-request-object-with-multiple-aud-succeeds-with-mtls",
    "configuration-filename": "authlete-fapi-rw-id2-mtls.json",
    "current-block": "Attempting reuse of client2's authorisation code & testing if access token is revoked",
    "condition": "CallAccountsEndpointWithBearerTokenExpectingError",
    "expected-result": "warning"
  },
  {
    "test-name": "fapi-rw-id2-with-private-key-and-mtls-holder-of-key",
    "configuration-filename": "authlete-fapi-rw-id2-privatekey.json",
    "current-block": "Attempting reuse of client2's authorisation code & testing if access token is revoked",
    "condition": "CallAccountsEndpointWithBearerTokenExpectingError",
    "expected-result": "warning"
  },
  {
    "test-name": "fapi-rw-id2-ensure-request-object-with-multiple-aud-succeeds-with-private-key-and-mtls-holder-of-key",
    "configuration-filename": "authlete-fapi-rw-id2-privatekey.json",
    "current-block": "Attempting reuse of client2's authorisation code & testing if access token is revoked",
    "condition": "CallAccountsEndpointWithBearerTokenExpectingError",
    "expected-result": "warning"
  },
  {
    "test-name": "fapi-rw-id2-with-private-key-and-mtls-holder-of-key",
    "configuration-filename": "authlete-fapi-rw-id2-privatekey-for-instructions.json",
    "current-block": "Attempting reuse of client2's authorisation code & testing if access token is revoked",
    "condition": "CallAccountsEndpointWithBearerTokenExpectingError",
    "expected-result": "warning"
  },
  {
    "test-name": "fapi-rw-id2-ensure-request-object-with-multiple-aud-succeeds-with-private-key-and-mtls-holder-of-key",
    "configuration-filename": "authlete-fapi-rw-id2-privatekey-for-instructions.json",
    "current-block": "Attempting reuse of client2's authorisation code & testing if access token is revoked",
    "condition": "CallAccountsEndpointWithBearerTokenExpectingError",
    "expected-result": "warning"
  },
  {
    "test-name": "fapi-ciba",
    "configuration-filename": "authlete-fapi-ciba-privatekey-ping-dcr.json",
    "current-block": "Attempting reuse of client2's auth_req_id (which should fail) then testing if access token is revoked",
    "condition": "CallAccountsEndpointWithBearerTokenExpectingError",
    "expected-result": "warning",
    "comment": "Authlete doesn't invalidate access tokens when auth_req_id is reused"
  }
]
